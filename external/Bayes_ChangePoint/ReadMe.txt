%************************************************************************/
%* The Bayesian Change Point algorithm - A program to caluclate the     */
%* posterior probability of a change point in a time series.            */
%*                                                                      */
%* Please acknowledge the program author on any publication of          */
%* scientific results based in part on use of the program and           */
%* cite the following article in which the program was described.       */
%*                                                                      */
%* E. Ruggieri.  "A Bayesian Approach to Detecting Change Points        */
%* in Climatic Records," International Journal of Climatology           */
%*                                                                      */
%* Program Author: Eric Ruggieri                                        */
%* Duquesne University                                                  */
%* Pittsburgh, PA 15282                                                 */
%* Email:  ruggierie@duq.edu                                            */
%*                                                                      */
%* Copyright (C) 2012  Duquesne University                              */
%*                                                                      */
%* The Bayesian Change Point algorithn is free software: you can        */
%* redistribute it and/or modify it under the terms of the GNU General  */
%* Public License as published by the Free Software Foundation, either  */
%* version 3 of the License, or (at your option) any later version.     */
%*                                                                      */
%* The Bayesian Change Point algorithm is distributed in the hope that  */
%* it will be useful, but WITHOUT ANY WARRANTY; without even the        */
%* implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR      */
%* PURPOSE.  See the GNU General Public License for more details.       */
%*                                                                      */
%* You should have received a copy of the GNU General Public License    */
%* along with Bayesian Change Point.  If not, see                       */
%* <http://www.gnu.org/licenses/> or write to                           */
%* Free Software Foundation, Inc.                                       */
%* 51 Franklin Street Fifth Floor                                       */
%* Boston, MA 02110-1301, USA.                                          */
%************************************************************************/

Main Script: Bayes_changepoint.m
By default, the algirhtm is coded to run the Global Surface Temperature Anomaly 
time series [Temperatures.txt] analyzed in the manuscript. To run a different 
data set, modifications are needed only where the data is loaded and where 
figures are created.

Outline of the Bayesian Change Point algorithm:
1) Load the Data  
2) Define the Parameter Values
3) Calculate the Probability Density of the Data for Each Sub-Interval
4) Forward Recursion [Dynamic Programming]
5) Stochastic Backtrace via Bayes Rule
      a) Sample a Number of Change Points
      b) Sample the Location of the Change Points
      c) Sample the Regression Parameters Between Adjacent Change Points
6) Plot the Results
________________________________________________________________________
Associated functions:
partition_function.m - Performs the Forward Recursion step of the Bayesian Change Point 
		       algorithm.  Equations (3) and (4).
logsumlog.m - Probability densities are stored in logarithmic form, so this function adds 
	      numbers that are stored as logarithms and outputs their sum, saved as a logarithm.
pick_k1.m - General function that samples from a probability distribution. 

________________________________________________________________________
Description of Variables:


User Specified Variables:
Y = Data set / time series.   		N x 1 vector 
x = Time points which may or may not be equally spaced
X = Predictor variables.     		N x m matrix 
    In the case of the global surface temperature anomalies time series, a linear model

N = Number of data points
m = Number of regressors

k_max = Maximum number of change points allowed
d_min = Minimum distance between adjacent change points
k_0 = Hyperparameter for the prior on the regression coefficients (betas)
beta0 = Mean of multivariate normal prior on regression coefficients.		m x 1 vector 
v_0, sig_0 = Hyperparameter for scaled inverse chi-square prior on the variance

num_samp = Number of sampled solutions


Variables Generated by Algorithm:
Py = Probability density of the data for every possible substring of the data.  N x N matrix  
     Equation (2).  

P = Probability density of the data containing k change points.			k x N matrix
    Equations (3) and (4).    
num_comb = Number of change point solutions, used in Equation (6). 		N x N matrix 
k = Posterior distribtuion on the number of change points.  Equation (7)	k_max x 1 vector

chgpt_loc = Posterior probability of a change point at each data point		1 x N vector 
samp_holder = Contains the 'num_samp' individual change point solutions		num_samp x k_max matrix
	      Equation (8)

BETA = The average regression coefficient for each of the predictors at each data point
       Equation (10)								m X N matrix
model = The average model produced by the Bayersian Change Point algorithm	1 x N vector 

R_2 = R^2 value for the model
I = m x m identify matrix, used in calculation of Beta's
ax, gca, h1, h2 = Variables related to the figure produced at the end of the script.
